<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #222;
    color: #eee;
    padding: 20px;
    max-width: 700px;
    margin: auto;
  }
  label {
    font-weight: bold;
    display: block;
    margin-bottom: 8px;
    font-size: 16px;
  }
  select {
    width: 100%;
    padding: 8px;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid #444;
    background-color: #333;
    color: #eee;
  }
  button {
    background-color: #5a9;
    color: white;
    border: none;
    padding: 10px 18px;
    font-size: 16px;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #48a868;
  }
  .remove-btn {
    background-color: #d55;
    padding: 5px 10px;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    border: none;
    color: white;
  }
  .remove-btn:hover {
    background-color: #b33;
  }
  .main-item-box {
    border: 2px solid #4a9;
    border-radius: 10px;
    padding: 15px 20px;
    margin-bottom: 20px;
    background-color: #2a2a2a;
  }
  .child-item {
    margin-bottom: 10px;
    display: flex;
    gap: 8px;
    align-items: center;
  }
  .child-item select {
    flex-grow: 1;
  }
  #addMainItemBtn {
    margin-bottom: 25px;
  }
  pre {
    background-color: #111;
    border: 1px solid #555;
    padding: 15px;
    border-radius: 8px;
    font-size: 14px;
    overflow-x: auto;
    max-height: 400px;
  }
</style>

<h2>Inventory Builder</h2>

<div id="mainItemsContainer"></div>
<button id="addMainItemBtn">+ Add Main Item (max 5)</button>

<button style="width: 100%; margin-top: 15px;" onclick="generateJSON()">Generate JSON</button>

<h3>Generated JSON:</h3>
<pre id="jsonOutput"></pre>

<script>
  const itemIDs = [
    "None",
    "item_anti_gravity_grenade",
    "item_apple",
    "item_arrow",
    "item_arrow_heart",
    "item_arrow_lightbulb",
    "item_backpack",
    "item_backpack_black",
    "item_backpack_green",
    "item_backpack_large_base",
    "item_backpack_large_basketball",
    "item_backpack_large_clover",
    "item_backpack_pink",
    "item_backpack_small_base",
    "item_backpack_white",
    "item_backpack_with_flashlight",
    "item_balloon",
    "item_balloon_heart",
    "item_banana",
    "item_baseball_bat",
    "item_big_cup",
    "item_boombox",
    "item_boombox_neon",
    "item_box_fan",
    "item_calculator",
    "item_cardboard_box",
    "item_cash",
    "item_cash_mega_pile",
    "item_cash_pile",
    "item_clapper",
    "item_cluster_grenade",
    "item_cola",
    "item_cola_large",
    "item_company_ration",
    "item_company_ration_heal",
    "item_cracker",
    "item_crate",
    "item_crossbow",
    "item_crossbow_heart",
    "item_crowbar",
    "item_disc",
    "item_disposable_camera",
    "item_dynamite",
    "item_dynamite_cube",
    "item_egg",
    "item_flaregun",
    "item_flashbang",
    "item_flashlight",
    "item_flashlight_mega",
    "item_flashlight_red",
    "item_floppy3",
    "item_floppy5",
    "item_football",
    "item_frying_pan",
    "item_glowstick",
    "item_goldbar",
    "item_grenade",
    "item_heart_chunk",
    "item_heart_gun",
    "item_heartchocolatebox",
    "item_hh_key",
    "item_hookshot",
    "item_hoverpad",
    "item_impulse_grenade",
    "item_jetpack",
    "item_keycard",
    "item_lance",
    "item_large_banana",
    "item_mug",
    "item_nut",
    "item_ogre_hands",
    "item_ore_copper_l",
    "item_ore_copper_m",
    "item_ore_copper_s",
    "item_ore_gold_l",
    "item_ore_gold_m",
    "item_ore_gold_s",
    "item_ore_hell",
    "item_ore_silver_l",
    "item_ore_silver_m",
    "item_ore_silver_s",
    "item_painting_canvas",
    "item_paperpack",
    "item_pelican_case",
    "item_pickaxe",
    "item_pickaxe_cny",
    "item_pickaxe_cube",
    "item_pipe",
    "item_pinata_bat",
    "item_plunger",
    "item_pogostick",
    "item_police_baton",
    "item_pumpkin_pie",
    "item_pumpkinjack",
    "item_pumpkinjack_small",
    "item_quiver",
    "item_quiver_heart",
    "item_radioactive_broccoli",
    "item_randombox_mobloot_big",
    "item_randombox_mobloot_medium",
    "item_randombox_mobloot_small",
    "item_randombox_mobloot_weapons",
    "item_revolver",
    "item_revolver_ammo",
    "item_revolver_gold",
    "item_rope",
    "item_rpg",
    "item_rpg_ammo",
    "item_rpg_ammo_egg",
    "item_rpg_cny",
    "item_rpg_easter",
    "item_rubberducky",
    "item_ruby",
    "item_saddle",
    "item_scanner",
    "item_scissors",
    "item_shield",
    "item_shield_bones",
    "item_shield_police",
    "item_shotgun",
    "item_shotgun_ammo",
    "item_shredder",
    "item_shrinking_broccoli",
    "item_snowball",
    "item_stapler",
    "item_stick_armbones",
    "item_stick_bone",
    "item_sticker_dispenser",
    "item_sticky_dynamite",
    "item_stinky_cheese",
    "item_tablet",
    "item_tapedispenser",
    "item_tele_grenade",
    "item_theremin",
    "item_timebomb",
    "item_toilet_paper",
    "item_toilet_paper_mega",
    "item_toilet_paper_roll_empty",
    "item_treestick",
    "item_tripwire_explosive",
    "item_trophy",
    "item_turkey_leg",
    "item_turkey_whole",
    "item_umbrella",
    "item_umbrella_clover",
    "item_unidentified",
    "item_upsidedown_loot",
    "item_uranium_chunk_l",
    "item_uranium_chunk_m",
    "item_uranium_chunk_s",
    "item_whoopie",
    "item_zipline_gun"
  ];

  const mainItemsContainer = document.getElementById('mainItemsContainer');
  const addMainItemBtn = document.getElementById('addMainItemBtn');

  // Create a select filled with itemIDs (excluding "None")
  function createItemSelect() {
    const select = document.createElement('select');
    itemIDs.forEach(item => {
      if(item !== "None"){
        const option = document.createElement('option');
        option.value = item;
        option.textContent = item;
        select.appendChild(option);
      }
    });
    return select;
  }

  // Create a main item box with UI to pick main item and children
  function createMainItemBox() {
    const box = document.createElement('div');
    box.className = 'main-item-box';

    // Main item label + remove main item button
    const mainLabel = document.createElement('label');
    mainLabel.textContent = 'Choose Main Item:';

    const mainSelect = createItemSelect();

    const removeMainBtn = document.createElement('button');
    removeMainBtn.textContent = 'Remove Main Item';
    removeMainBtn.className = 'remove-btn';
    removeMainBtn.type = "button";

    removeMainBtn.addEventListener('click', () => {
      mainItemsContainer.removeChild(box);
      updateAddMainItemBtn();
    });

    // Children container + add child button
    const childrenTitle = document.createElement('h4');
    childrenTitle.textContent = 'Children Items:';

    const childrenContainer = document.createElement('div');

    const addChildBtn = document.createElement('button');
    addChildBtn.textContent = '+ Add Child Item';
    addChildBtn.type = "button";
    addChildBtn.style.marginBottom = '20px';

    addChildBtn.addEventListener('click', () => {
      const childDiv = document.createElement('div');
      childDiv.className = 'child-item';

      const childSelect = createItemSelect();

      const removeChildBtn = document.createElement('button');
      removeChildBtn.textContent = 'Remove';
      removeChildBtn.className = 'remove-btn';
      removeChildBtn.type = "button";

      removeChildBtn.addEventListener('click', () => {
        childrenContainer.removeChild(childDiv);
      });

      childDiv.appendChild(childSelect);
      childDiv.appendChild(removeChildBtn);
      childrenContainer.appendChild(childDiv);
    });

    // Append everything
    box.appendChild(mainLabel);
    box.appendChild(mainSelect);
    box.appendChild(removeMainBtn);
    box.appendChild(childrenTitle);
    box.appendChild(childrenContainer);
    box.appendChild(addChildBtn);

    return { box, mainSelect, childrenContainer };
  }

  function updateAddMainItemBtn() {
    addMainItemBtn.disabled = mainItemsContainer.children.length >= 5;
  }

  addMainItemBtn.addEventListener('click', () => {
    if (mainItemsContainer.children.length >= 5) return;

    const { box } = createMainItemBox();
    mainItemsContainer.appendChild(box);
    updateAddMainItemBtn();
  });

  // Start with 1 main item box
  addMainItemBtn.click();

  function generateJSON() {
    const objects = [];

    Array.from(mainItemsContainer.children).forEach(box => {
      const mainSelect = box.querySelector('select');
      const mainItemID = mainSelect.value;

      const childrenContainer = box.querySelector('div');
      const children = [];

      // The childrenContainer is the div with all child-item divs
      childrenContainer.querySelectorAll('.child-item select').forEach(childSelect => {
        children.push({
          itemID: childSelect.value,
          colorHue: 0,
          colorSaturation: 0,
          scaleModifier: 0,
          children: []
        });
      });

      objects.push({
        itemID: mainItemID,
        colorHue: 0,
        colorSaturation: 0,
        scaleModifier: 0,
        children: children
      });
    });

    const data = {
      objects: [
        {
          collection: "user_inventory",
          key: "stash",
          permission_read: 1,
          permission_write: 1,
          value: JSON.stringify({
            version: 1,
            items: objects
          })
        }
      ]
    };

    document.getElementById('jsonOutput').textContent = JSON.stringify(data, null, 2);
  }
</script>
